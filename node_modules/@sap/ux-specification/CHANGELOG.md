# Change Log

All notable changes to this project are documented in this file.

This project adheres to [Semantic Versioning](http://semver.org/) and the changelog is formatted based on [Keep a Changelog](http://keepachangelog.com/).

## [1.71.49] - 2022-01-26

### Added

- OData V2:
  - `exportType` property can now be configured to specify the type of export to be used in the SmartTable control.

### Changed

### Removed

### Deprecated

### Fixed

### Quality

- Upgrade of node-fetch

## [1.71.48] - 2022-01-12

### Added

- OData V2:
  - OP: properties of footer actions are displayed and supported in side panel
  - properties of toolbar actions are displayed and supported in side panel
  - OVP: The property `showLineItemDetail` is now supported for List and Table cards
  - OP: Schema now supports column extensions for TreeTable

### Changed

- OData V2:
  - property `filterDefaultsFromSelectionVariant` is now only supported for AnalyticalListPage floorplan
  - OVP: The property `tabs` and `addOdataSelect` can now be confirued for all cards

### Removed

- OData V2:
  - OVP: removed `tabs` property from card level

### Fixed

- OData V2:
  - correct schema generation in case multiple facets are referring to lineitem annotation of same entity
  - Facet Id is considered for import and export of manifest settings
  - Fixed sync issues in case no text is provided for custom columns

### Quality

- Upgrade of trim-off-newlines
- Upgrade of yarn classic
- New whitesource endpoint
- Upgrade of follow-redirects

## [1.71.47] - 2021-12-01

### Added

- Enum support for annotationPath as part of quick variant selection or views
- Enum support for entitySet of multiple views' scenario

### Fixed

- Schemas and configs are now generated for applications without annotations

### Quality

- New build version build:dev without generation of documentation html
- Fixed an issue with missing `log` function after webpack

## [1.71.46] - 2021-11-17

### Added

- OData V4: Enhance schema with `dataType`, `annotationPath` information for display on columns, fields and selection fields in Page editor

### Fixed

- Invalid references in generated schemas have been fixed.

## [1.71.45] - 2021-11-03

### Changed

- OData V2: Enhanced sync logic to use generic approach for handling unknown properties. As a result sync logic is more robust and handles more unknown properties.
- In the JSON schema, the description of DataPoints as part of sections or header facets now reflects the Title of the target annotation.

### Quality

- Code smell solved: "Define a constant instead of duplicating this literal n times."

## [1.71.44] - 2021-10-20

### Added

- OData V2:
  - Support for (Sub)Section properties: `visible`.
  - Footer actions are now part of the schema. A node for header actions is visible even if there are no actions yet.
  - ALP: Schema now comprises of entity properties for config `createWithParameterDialog`->`fields`
  - OP: Added support for multiple flex changes in Form and Header Actions

### Changed

### Removed

- OData V2:
  - OVP: Removed `tab` property from `Stack` and `Link List` cards as view switch control is not supported

### Fixed

- OData V2:
  - Add `visible` property to DataField types
  - Replace alias of namespace definitions of header actions even for references that are not related to OData vocabularies.
  - annotationPath definitions of header and footer actions.

### Quality

- Settings for sonarlint have been added.

## [1.71.43] - 2021-10-06

### Added

- Annotation path `com.sap.vocabularies.UI.v1.HeaderInfo` added to ObjectPageHeader schema.
- `i18nClassification` for `title`, `description` properties for `App.json` schema in V2.
- OData V2:
  - OVP: Added support for property `annotationPath` in Linklist card settings.
  - OVP: property `requireAppAuthorization` is now supported for all card types.

### Changed

- README was updated.
- Order and naming of view nodes for the V2 Object Page adapted.
- Pattern for binding changes in V2: there are now two different patterns for List Report and Object Page; the one for the Object Page  provides the additional enum values  "{ui>/editable}" and "{= !${ui>/editable}}".

### Quality

- Fix of vulnerabilities by upgrade of npm modules.
- Fix of bugs and code smells reported by SonarQube.

## [1.71.42] - 2021-09-22

### Added

New html files showing a graphical representation of the content of each generic schema.

OData V2:

- We show field groups and fields now as part of the app specific schema, and allow the maintenance of the visible property for fields.
- Support of property `flexEnabled`on app level.

### Changed

The default for titles and labels of schema nodes - in case of missing annotation labels - has been adapted, for facets and header facets. There will be node-specific content now in all cases instead of generic defaults like "Form".

### Fixed

- OData V2:
  - Invalid flexChanges are now ignored during sync, hence configs and pages files are created.

### Quality

- Bugs and code smells removed that had been detected by SonarQube.

## [1.71.41] - 2021-09-08

### Added

- OData V2:
  - OVP: Added support for property `dataPointAnnotationPath` in ListCard settings

## [1.71.40] - 2021-08-25

### Added

- Added test for function `convertInterfaces` to increase test coverage
- Added flexchange layer information to API interface

### Changed

- OData V2: Unresolvable facets are not returned by schema to avoid creation of corrupted custom sections

### Fixed

- Object Page schema generation crash when 'Facets' entry is not defined for 'CollectionFacet'
- Page schema generation - `annotationPath` was missing for `table/toolbar`

## [1.71.39] - 2021-08-12

### Added

- OData V2:
  - Added description property to header actions in schema
  - Table toolbar as structure node
  - Added properties showClearOnFB, showFilterConfiguration and showRestoreOnFB to the FilterBar

- Developer guide for contributors to this module

- Actualization of JS-DOC

- Enhanced error handling of API functions.

- The generic schema is enhanced by the following information:
  - artifact type (manifest setting, flex change or annotation)
  - in case of flex change: control name

### Changed

- The node Selection Fields was renamed to Filter Fields, in accordance with the UI.

- The generic schemas now already comprise anyOf definitions for enums of type string that allow binding changes. Previously this was only added during the generation of app specific schemas.

### Fixed

- A common function was introduced to resolve path references of Common.Label annotations; endless loop references are interjected, the variable value or key is returned in this case.
- Enhance function determineTableType to also check for presence of old tableType flag in manifest.json
- OData V2:
  - ALP: Use correct Id for flex changes generated in case of Filter Bar

### Quality

- Refactor interfaces and class definitions for ALP tables

## [1.71.38] - 2021-07-28

### Added

- OData V2: Added growingThreshold property to Responsive Tables

### Fixed

- When starting the app modeler for certain CDS projects, an exception occurs, and no pages nor schemas are listed.
- Modified regex used in binding properties to avoid issues with Shebang plugin during consumption of specification module.

### Quality

- Upgrade of Annotation Vocabularies Tools to version 0.3.28.

## [1.71.37] - 2021-07-14

### Added

- annotationPath is added to the selectionFields node.

### Changed

- The import functions for filling the content of config files are now instantiating the required metadata based on factory classes (that had been introduced for the export before).

### Fixed

- In the annotationPath of columns, qualifiers had not been added.
- The namespace of the entity type is now present in all annotation paths.
- Changing binding value to false removed flex changes from the file system.
- The logic for section generation in app schemas did not consider qualifiers correctly.

### Quality

- Missing path to types in package.json was added. This is required because after introducing bundling with webpack, the index.d.ts file is not next to index-min.js.

## [1.71.36] - 2021-06-30

### Changed

- In the annotationPath information of the generated JSON schemas all alias definitions are now replaced by the full vocabulary name.
- Descriptions in the schema now follow the following paradigm:
  - For facets we need use title and description, the export logic takes the title and extracts the facet key from it for concatenating the stable ID. The text that shall be shown in the Page Editor shall be the description.  
  - Thus we now generalise: all view nodes (isViewNode = true) have a description (but do not necessarily need a title).  
  - Properties (no isViewNode tag) are not listed in the outline, but in the properties panel. Here, the title shall be used as a label, and the description shall be shown on hover (old UI) or rendered directly (new UI).

### Fixed

- The deletion of a custom section from the config file was not reflected in manifest.json.
- New page export fails if parent page does not have navigation property defined.
- Navigation is not cleared if we remove last associated page.
- The import of unknow flex change properties into the config is now avoided.
- The export of flex changes sometimes generated multiple flex changes into the dev workspace.
- The script for extracting documentation had neglected patternProperties of the schemas.
- An exception occurred in case of invalid annotation references, the schemas and config files were not generated in this case.
- Too many actions had been listed as table columns: now it is restricted to the inline actions.

### Quality

## [1.71.35] - 2021-06-17

### Added

- annotationPath added as metadata to the columns in JSON schema.

### Changed

- The enum for fragment names of column extension is more restrictive now, it does not comprise cells anymore.
- webpack uglify function names.

### Fixed

- Fix for launch config Import project which can be used to debug the import of a project.
- During the export, fragments are not deleted anymore, as they may comprise customer coding.
- If a fragment is not present yet, it gets created now, i.e. added with an <root> prefix to the list of fragments.
- yarn watch allows debugging of custom extensions now, as the templates are available again in the dist folder.
- Correct sync logic to make sure that config changes are written only to desired places in manifest.json.
- An exception had occurred in case of invalid target annotation paths, this is caught now.
- OData V2 - Flex changes not supported by specification module remain unaffected by the sync logic
- OData V2 - Avoid creation of duplicate flex changes in case of Object Page tables
- OData V2 - ALP: Improved sync logic as some of the supported flex chagnes were not imported to config files

## [1.71.34] - 2021-06-03

### Changed

- The access to reflect metadata is now centralized in factory classes and thus runs in a generic way in most situations.

### Fixed

- Path references of labels had not been resolved correctly. Common.label annotations of the target reference are now considered correctly.
- The regex pattern for binding changes was incomplete, resulting in validation errors.

### Quality

Upgrades of dependencies to:

- "ts-loader": 9.1.2
- node version 12
- "webpack": 5.37.1
- "chalk": "4.1.1"
- "ejs": "3.1.6"
- "i18next": "20.3.1"
- "ts-json-schema-generator": "0.93.0"

Added resolutions for

- "glob-parent": "^5.1.2"
- "normalize-url": "^6.0.1"
- "ws": "^7.4.6"
- "trim-newlines": "^3.0.1"

## [1.71.33] - 2021-05-20

### Fixed

- OData V2: Variant Management flex changes are now ignored

## [1.71.32] - 2021-05-06

### Added

- New tag displayName in JSON schema: used to switch the name in the UI when needed, the original schema name is not changed due to compatibility reasons.
- New tag dataType in JSON schema for V4 Form and Object Page: as a tag, this can be rendered display-only as an additional information for any data field.

### Changed

- Documentation updates, due to introduction of the additional version for UI5 1.89
- Schema file names are now based on entitySet instead of entityType

### Fixed

- OData V2: LR/OP/ALP - Unknown properties are now excluded from export which in turn also avoids deletion of properties unknown to specificaiton from manifest.
- No invalid references anymore at the generated JSON schemas.

## [1.71.31] - 2021-04-26

### Quality

- lodash upgrade

## [1.71.30] - 2021-04-22

### Fixed

- List report V2: too many properties had been presented at LSP for analytical table.

### Quality

- Switch build to webpack
- Upgrade of Annotation-Vocabularies-Tools

## [1.71.29] - 2021-04-15

### Quality

- Upgrade of handlebars

## [1.71.28] - 2021-04-09

### Changed

- quickVariantSelection and quickVariantSelectionX definitions are more general no, allowing any number of tabs.

### Fixed

- OData V2: ALP - ignoredChartTypes property now supports more values
- Export of quickVariantSelectionX in V2 was wrong or could lead to exception

## [1.71.27] - 2021-03-25

### Fixed

- No duplicate entries in the result lists of scripts for extracting documentation

## [1.71.26] - 2021-03-11

### Added

- Property valueSelectionInfo of OVP cards
- Tag isViewNode now marks schema elements that are relevant for setting up an out line or schematic view of a page; (complex) properties are not marked like that.
- Tag i18nClassification marks properties of the schema that are relevent for translation; it uses the key words following the SAP guidelines for translation.

### Fixed

- Export of OVP card of the new V4 types to manifest
- OVP: Unknown properties are now excluded from export

## [1.71.25] - 2021-02-25

### Added

- Mark translatable properties in `schema` with `isLanguageDependent` property.

### Fixed

- Exceptions have occurred in case of incomplete or inconsistent annotations. This was solved by a new version of the Annotation Vocabulary Tools that is delivered together with the Specification module.

- Duplicate property "entitySet" for link list cards got removed.

### Quality

- Switch to Sonar EE

## [1.71.24] - 2021-02-11

### Fixed

- Overview Page: mandatory fields are clarified and reworked
- Overview Page: obsolete field timeAxis eliminated
- Object Page V2: `XML` type is only valid type for selection for Custom Section Fragment definition

### Quality

- Dependencies to other npm modules have been actualized

## [1.71.23] - 2021-01-28

### Fixed

- Flex changes for ALP table columns had been written with the wrong selector id and thus had no effect in the run-time.

### Quality

- Dependencies to other npm modules have been actualized

## [1.71.22] - 2021-01-07

### Added

- The specification API now allows passing a logger, i.e. an instance of the new interface ExtensionLogger.
If supplied, all messages resulting from the API processing will be passed to the logger instance instead of console.log.
- OData V2: Support for Custom Columns in Object Page tables.
- OData V2: New extensionType property is added to Custom Column definition.

### Fixed

- OData V2: Export fails to resolve page in `manifest.json` when page key does not contain entitySet.

## [1.71.21] - 2020-12-03

### Added

- OVP custom card - `template` property uses pattern to avoid non-custom card template overlap
- OVP cards - `model` property uses enum entries populated from `manifest.json`
- OData V2: New `extensionType` property is added to Custom Column definition
- OData V2: Support for Custom Columns in Object Page tables

### Changed

- OData V2: Use enum instead of string for property `createWithFilters -> strategy`

### Fixed

- OData V2: Improved sync logic to avoid deletion of entries from page config

## [1.71.20] - 2020-11-19

### Added

- Support of custom columns for List Report and Analytical List Page of Fiori Elements V2: this includes read and write
capabilities for both the manifest extension section and the fragment files; the API is enhanced by optional parameters so that the extension fragments can be passed.
- Support keyPerformanceIndicators(KPI) cards in Analytical list page

### Changed

- README enhanced by support section
- The specification API now returns a _complete_ list of flex changes, not only the updated ones; if a flex property was not maintained or deleted, you can find it in the list with content.newValue = null. This allows the consuming application to distinguish flex changes that are supported by the JSON schema of the specification from other flex changes that may have been created by other means; only changes that are part of the result list of the API but have content.newValue = null should get deleted from the app.
- Version 0.3.1 of Annotation vocabularies tools is used now.

### Removed

- Redundant occurence of property `smartVariantManagement` in table config

### Fixed

- Deletion of an object page from the app.json configuration did not work
- Fixed export import of an object page header property
- When creating an app based on an OData V3 service like the Northwind service of odata.org, the app modeler failed with an exception
- OData V2: Corrected sync issues with property `createWithFilters` in case of `GridTable`

## [1.71.19] - 2020-11-05

### Changed

- Update description of npm package to "SAP Fiori tools - Specification"

### Fixed

- Adjustments to the regex used for binding changes, as introduced in previous version:
    1. accept false as value
    2. only allow the exact value from enums but no alteration
- Different enum for pageType in app.json for V2 and V4(not included)

## [1.71.18] - 2020-10-22

### Added

- Full support for binding changes as an option for the property values of
    List report + ALP: hAlign of table columns, popinLayout
    Object page: popinLayout, displayShape, header actions, hAlign of table columns

### Changed

- Dependencies updated:
    "@sap-ux/annotation-converter": "0.2.37",
    "@sap-ux/edmx-parser": "0.2.33,
    "@sap-ux/vocabularies-types": "0.2.33"
- OData V2: `showDraftToggle` property is now only part of List Report schema

### Fixed

- Fixed exception for freestyle views as part of an app
- Deletion of object page header transferred correctly
- Export import for header properties are consistent

## [1.71.17] - 2020-10-09

### Added

- OData V2: properties `variantManagementHidden` and `subTitleIfVariantMgmtHidden`

### Fixed

- Passed manifest should not be modified by the specification API
- The outline view of the page map did not show all sections or facets

## [1.71.16] - 2020-09-28

### Added

- Table columns now have a description that appears on hover, showing the column header title as visible in the application at run-time.
    This description is also visible at the input help (LSP) when chosing a column at any configuration file.

### Changed

- Analytical List Page OData V2: showGoButtonOnFilterBar property moved to **filterbar** section in config

### Fixed

- Property displayShape of Analytical List Page was not imported correctly.
- Generate correct app specific schema for ALP in V4
- Generation of app specific schemas generally ran into exceptions for apps without LineItem or Facet annotation.
    To fix this, the schema generation got changed so that it runs over the existing pages as registered in manifest.json, instead of being based on the LineItem and Facet annotations.

### Quality

Test coverage increased

## [1.71.15] - 2020-09-11

### Added

- Validity information for various properties

### Changed

- Pipeline settings now support intermediate staging
- New version of Annotation Vocabularies Tools
- Description for createWithFilters

### Removed

- The property allFiltersAsInParameters is invalid for the given release and thus got deleted.

### Fixed

- Import properties correctly for ALP

## [1.71.14] - 2020-08-27

### Added

- importProject API: support of OVP and ALP templates

### Changed

- Use @ui5/flexibility-utils for stringify/parse flex changes

### Deprecated

### Removed

### Fixed

- Synchronization of changes in manifest.json
- Properties objectPageHeaderType and showDraftToggle are not shown anymore as part of app.json (JSON schema validation error)
- Wrong ID at generated flex changes for object page table columns
- Fixed issue related to page map and app.json while exporting
- Sections not shown correctly in the page map for V4 applications
- Shows warning in case of invalid card name for overview page
- Enhanced test coverage: objectPageHeaderAction
- Manifest did not get updated in case of deletion of some of the properties from config file

## [1.71.13] - 2020-08-21

### Added

- Support UI Flex binding change for header action

## [1.71.12] - 2020-08-07

### Removed

- `postPublish` script to avoid issues with `npm pack`

## [1.71.11] - 2020-08-06

### Added

- `getApiVersion()` added

### Changed

- Renaming API method from `importProjectNoConfig()` to `importProjectSchema()`.

### Fixed

- Fix for custom section export

## [1.71.10] - 2020-07-30

### Fixed

- enableAutoBinding re-enabled on table level

### Removed

- `tableColumnVerticalAlignment`, as not valid in 1.71
- Possibility to define different tableSettings per variant in case of multiple tabs
- `loadDataOnAppLaunch`, as not valid in 1.71
- enableAutoBinding for `quickVariantSelectionX` (multiple tabs)

## [1.71.9] - 2020-07-29

### Added

- Support of subsections in the object page schema
- Full support of flexible column layout for Fiori Elements V2 and V4
- New API `importProjectNoConfig` for generation of all schemas without generation of configs
- Fault-tolerance in case of incomplete app projects
- New properties for V2 applications:

    1. `tableColumnVerticalAlignment` (on app level)
    2. Possibility to define different tableSettings per variant in case of multiple tabs

### Changed

- File naming of schemas is based on entity type now, central function for determination of schema file name
- App providers as well as the API importProject have been enhanced
- enableAutoBinding on table level is replaced by `loadDataOnAppLaunch`; alternatively, enableAutoBinding for `quickVariantSelectionX` (multiple tabs) is also considered

### Deprecated

### Removed

- Property `createWithFilters` is removed from Analytical List Page schema

### Fixed

- Synchronization of changes in manifest.json and delete complete block
- Deletion of last setting/block from configuration file
- Boolean value false was not written to manifest but the property was deleted
- Export of V4 app.json may lead to empty structures like config: {} in the manifest
- Exception occured in case of free-style pages as part of the manifest
- Exception occured during the import of invalid UI flexibility changes
- Wrong ID's had been written to UI flexibility changes in case of (complex) annotation paths like columns of type DataFieldForAnnotation;
    the changes then either disappeared after reload or had still been visible but without any implication on the app

## [1.71.8] - 2020-07-06

### Removed

- Property `flexibleColumnLayout` is removed from application schema (app.json)
- Property `createWithFilters` is removed from Analytical List Page schema

### Fixed

- Sync between changes file and pages config for ALP
- Generation of correct config file for ALP
- Enhance test coverage for ALP(included import)
- Correct descriptions for properties `title` and `description` in app.json
- Different schema for Analytical Table in case of List Report and Analytical List Page

## [1.71.7] - 2020-06-24

### Fixed

- Missing descriptions added to schemas
- Analytical List Page Schema enhanced to show only relevant properties

## [1.71.6] - 2020-06-17

### Added

- Support for Analytical List Page (ALP)
- Support flex changes for ALP
- Use ui5-flexibility-utils for read write flex changes

### Fixed

- Consistent values and validation for all table types of list report and object page
- OVP: Property 'template' now shows Analytical card irrespective of other properties
- Existing manifest settings now remain unaffected during export
- Handle partial deletion of a page from app.json
- Switch to annotation-vocabularies-tools to parse, merge and convert annotations.
    This fixes issues with merged annotations.
- Added bundled dependency

## [1.71.5] - 2020-05-20

### Added

- Support for Analytical List Page (ALP)
- new API `importProject()` to create schema and config files

### Fixed

- Show consistent value/validation for all table type in list report page
- OVP: Property 'template' now shows Analytical card irrespective of other properties
- Existing manifest settings now remain unaffected during export
- Show consistent value/validation for all table type in object page
- Handle partial deletion of a page from app.json

### Changed

- `ServiceMetadata` not required anymore to generate schemas

## [1.71.4] - 2020-05-05

### Added

- Support grid table, analytical and tree table besides responsive table for configuration settings
- Table type specific flex changes. For example: includeItemInSelection and popinLayout are only available for the responsive table
- Table type specific manifest changes. For example: createWithFilters is available for all the table types except tree table and condensedTableLayout is available in all object page table except responsive table
- Flex changes have no dedicated format in the API interface anymore, but are passed as an array of strings to importConfig, i.e. any file content can be passed immediately. The structure of a flex change thus is only known to the specification module and can change over time (aka UI5 release).
    exportConfig is enhanced the same way.
- No need to supply annotations anymore while calling importConfig or exportConfig: the annotations are only evaluated during the generation of the app schema, all data which is necessary for subsequent import o export of config files will be comprised in this schema.
- Support export/import for OVP custom card.

### Fixed

- Exception when exporting V4 app configurations ('cannot read properies of undefined')
- If no table settings had been maintained, an empty object tableSettings: {} was written back to the mainfest.json
- Fallback for the table type (if not maintined explicitly) must be 'responsive table'

## [1.71.3] - 2020-04-22

### Added

- Alignment of table settings between V2 and V4, list report and object page: resolve the inner structure tableSettings, 'table' comprises all properties
- Alignment of order of parts of the list report page: filterbar before table
- OVP: showBasicSearch as property shall be used instead of enableBasicSearch
- Extractor for documentation enhanced by variant for IxiaSoft

### Fixed

- If a property is deleted from a config file, it does not get deleted from the manifest.json
- If a card was deleted from the OVP config, it was not deleted from the manifest.json
- If no routing is defined yet in manifest for a V4 page, the export of the corresponding app config leads to an exception
- if you add an invalid section identifier to an object page, ths invalid section gets written to the manifest
- Added 'showBasicSearch' property for Overview page and removed property 'enableBasicSearch'
- Evaluation and logging of deprecated properties

## [1.71.2] - 2020-04-15

### Added

- Activation of test coverage reports for sonarcube
- Page structure of V2 object page adjusted to current manifest schema
- Additional properties for overview page

### Fixed

- Prevent exceptions in case of missing sections of object pages
- V2: Manifest settings got overwritten by flex changes
- V2: Wrong page determination if working on object pages of deeper hierarchical level
- V2 object page: Flex changes had been applied to all object pages
- Exception in case of missing sections of object page
- Problems with the export of new or deleted pages (page map)
- Eliminate duplicate property enableTableFilterInPageVariant from filterbar
- Deletions at page config files did not reflect in manifest.json
- Provide the correct stable ID for popinLayout
- Mismatch in API for generation of OVP schemas
- V2 list report: Property includeItemInSelection is now correctly considered as a flex change
- Conversion issues during the export of OVP cards
- Ensure unique IDs for flex changes
- Return correct set of flex changes
- Use stable ID syntax for table column keys

## [1.71.1] - 2020-03-31

### Added

- CHANGELOG.md to document changes

### Fixed

- Fixed missing exports of interfaces
- Export support for object page

## [1.71.0] - 2020-03-20

### Added

- Specification for Fiori Element V2:
  - List report
  - Object Page
  - Overview Page
- Specification for Fiori Elements V4:
  - List Report
  - Object Page
  - Support of custom pages
